[gd_scene load_steps=45 format=3 uid="uid://bjipm2lc5skd"]

[ext_resource type="Texture2D" uid="uid://beqs7lmdt8ajs" path="res://physics_enemy_sheet.png" id="1_0xm2m"]
[ext_resource type="Script" uid="uid://bf13qo63osdwl" path="res://timer_display.gd" id="2_7mycd"]
[ext_resource type="Script" uid="uid://boa1tjceghcpe" path="res://player.gd" id="2_h2yge"]
[ext_resource type="Script" uid="uid://crmnujf6i6tcn" path="res://player_healthbar.gd" id="3_272bh"]
[ext_resource type="SpriteFrames" uid="uid://cdtg4lurljt3d" path="res://player_anims.tres" id="3_h2yge"]
[ext_resource type="Script" uid="uid://bywkkfhw0eih0" path="res://time_manager.gd" id="4_1bvp3"]
[ext_resource type="Script" uid="uid://bpx3f8mx0v1pa" path="res://camera_3d.gd" id="4_2cqfq"]
[ext_resource type="Script" uid="uid://x101j7iv5bmf" path="res://physics_enemy.gd" id="4_272bh"]
[ext_resource type="Script" uid="uid://bqgn1a1yh82fp" path="res://line3d.gd" id="4_kek77"]
[ext_resource type="Script" uid="uid://bhaai2o87q120" path="res://enemy_healthbar.gd" id="5_5vw27"]
[ext_resource type="Script" uid="uid://cv27h3syynihb" path="res://physics_enemy_visuals.gd" id="7_4c57u"]
[ext_resource type="Script" uid="uid://cqy3l1ma2nt3k" path="res://mining_laser_weapon.gd" id="11_dg77c"]
[ext_resource type="Texture2D" uid="uid://brcr5533kdlwe" path="res://wirelesscharger.png" id="11_efxa6"]
[ext_resource type="Script" uid="uid://dfxuitol4a6wf" path="res://wireless_charger.gd" id="12_ycdy4"]
[ext_resource type="Texture2D" uid="uid://bg22x3k8tmoau" path="res://wirelesscharger_off.png" id="14_w48qg"]
[ext_resource type="MeshLibrary" uid="uid://cnj4v3v6k5wlb" path="res://wallz.tres" id="15_vivmo"]

[sub_resource type="SystemFont" id="SystemFont_5vw27"]
subpixel_positioning = 0

[sub_resource type="SystemFont" id="SystemFont_kek77"]
subpixel_positioning = 0

[sub_resource type="Environment" id="Environment_7dm0k"]
background_mode = 4

[sub_resource type="CylinderShape3D" id="CylinderShape3D_kek77"]
height = 0.2
radius = 0.4

[sub_resource type="CylinderShape3D" id="CylinderShape3D_5vw27"]
height = 0.2
radius = 0.4

[sub_resource type="CylinderShape3D" id="CylinderShape3D_efxa6"]
height = 1.0029297
radius = 0.4

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_4c57u"]
radius = 0.25976563
height = 1.1409912

[sub_resource type="Gradient" id="Gradient_efxa6"]
offsets = PackedFloat32Array(0, 0.14714715, 1)
colors = PackedColorArray(1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_dg77c"]
gradient = SubResource("Gradient_efxa6")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_efxa6"]
angle_min = 45.00001
angle_max = 45.00001
direction = Vector3(0, 1, 0)
spread = 30.619
initial_velocity_min = 1.0
initial_velocity_max = 2.0
color_ramp = SubResource("GradientTexture1D_dg77c")
hue_variation_min = -2.2351742e-08
hue_variation_max = 0.019999977

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_dg77c"]
transparency = 1
vertex_color_use_as_albedo = true
emission = Color(1, 1, 1, 1)
emission_energy_multiplier = 6.05
billboard_mode = 3
particles_anim_h_frames = 1
particles_anim_v_frames = 1
particles_anim_loop = false

[sub_resource type="QuadMesh" id="QuadMesh_ycdy4"]
material = SubResource("StandardMaterial3D_dg77c")
size = Vector2(0.02, 0.02)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_efxa6"]
blend_mode = 1
albedo_color = Color(1, 0, 0, 1)
emission_enabled = true
emission = Color(1, 0, 0, 1)
emission_energy_multiplier = 16.0
disable_receive_shadows = true

[sub_resource type="CylinderMesh" id="CylinderMesh_efxa6"]
material = SubResource("StandardMaterial3D_efxa6")
top_radius = 0.02
bottom_radius = 0.02
height = 1.0
radial_segments = 8
cap_top = false
cap_bottom = false

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_kek77"]
radius = 0.2915039
height = 1.1289673

[sub_resource type="BoxShape3D" id="BoxShape3D_7mycd"]

[sub_resource type="BoxMesh" id="BoxMesh_272bh"]

[sub_resource type="WorldBoundaryShape3D" id="WorldBoundaryShape3D_7mycd"]

[sub_resource type="Gradient" id="Gradient_1bvp3"]

[sub_resource type="GradientTexture2D" id="GradientTexture2D_lquwl"]
gradient = SubResource("Gradient_1bvp3")
fill_to = Vector2(0.0625, 0)
repeat = 1
metadata/_snap_enabled = true
metadata/_snap_count = 16

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_7mycd"]
albedo_texture = SubResource("GradientTexture2D_lquwl")

[sub_resource type="PlaneMesh" id="PlaneMesh_272bh"]
material = SubResource("StandardMaterial3D_7mycd")
size = Vector2(50, 50)

[sub_resource type="NavigationMesh" id="NavigationMesh_4c57u"]
vertices = PackedVector3Array(-15.8288355, 2.3408198, -15.831807, -15.628836, 2.3408198, -15.431807, 15.371164, 2.3408198, -15.631807, 15.771166, 2.3408198, -15.831807, -15.8288355, 2.3408198, 15.768194, -15.428835, 2.3408198, 15.568193, 15.571165, 2.3408198, 15.368193, 15.771166, 2.3408198, 15.768194, -0.6288347, 0.3408199, -2.4318066, -0.028835297, 0.3408199, -2.4318066, 0.17116547, 0.3408199, -3.2318068, 0.77116585, 0.3408199, -15.231807, 0.77116585, 0.3408199, -3.2318068, -0.8288355, 0.3408199, -2.031807, -15.228835, 0.3408199, -15.231807, -15.228835, 0.3408199, -2.031807, 1.3711643, 0.3408199, -3.2318068, 1.5711651, 0.3408199, -2.4318066, 15.171165, 0.3408199, -2.4318066, 15.171165, 0.3408199, -15.231807, -0.42883492, 1.34082, -2.031807, -0.42883492, 1.34082, -1.2318068, 0.37116432, 1.34082, -1.2318068, 0.37116432, 1.34082, -1.8318071, 0.17116547, 1.34082, -2.031807, 1.1711655, 1.34082, -2.031807, 1.1711655, 1.34082, -2.8318071, 0.37116432, 1.34082, -2.8318071, 0.5711651, 0.3408199, -0.83180714, -0.028835297, 0.3408199, -0.83180714, -0.028835297, 0.3408199, -0.23180676, 0.37116432, 0.3408199, -0.031806946, 1.5711651, 0.3408199, -1.8318071, 0.77116585, 0.3408199, -1.6318064, 0.37116432, 0.3408199, 8.168194, -0.2288351, 0.3408199, 8.368193, -0.2288351, 0.3408199, 15.168194, 15.171165, 0.3408199, 15.168194, -0.8288355, 0.3408199, -0.031806946, -0.8288355, 0.3408199, -1.031807, -0.8288355, 0.3408199, 8.168194, -15.228835, 0.3408199, 15.168194, -0.42883492, 2.3408198, 0.16819382, -0.42883492, 2.3408198, 7.968193, -0.028835297, 2.3408198, 7.968193, -0.028835297, 2.3408198, 0.16819382)
polygons = [PackedInt32Array(1, 0, 2), PackedInt32Array(2, 0, 3), PackedInt32Array(5, 4, 1), PackedInt32Array(1, 4, 0), PackedInt32Array(2, 3, 6), PackedInt32Array(6, 3, 7), PackedInt32Array(6, 7, 5), PackedInt32Array(5, 7, 4), PackedInt32Array(9, 8, 10), PackedInt32Array(10, 8, 11), PackedInt32Array(10, 11, 12), PackedInt32Array(8, 13, 11), PackedInt32Array(11, 13, 15), PackedInt32Array(11, 15, 14), PackedInt32Array(16, 12, 11), PackedInt32Array(16, 11, 17), PackedInt32Array(17, 11, 18), PackedInt32Array(18, 11, 19), PackedInt32Array(24, 23, 20), PackedInt32Array(20, 23, 22), PackedInt32Array(20, 22, 21), PackedInt32Array(24, 27, 23), PackedInt32Array(23, 27, 25), PackedInt32Array(25, 27, 26), PackedInt32Array(30, 29, 31), PackedInt32Array(31, 29, 28), PackedInt32Array(32, 17, 18), PackedInt32Array(28, 33, 32), PackedInt32Array(28, 32, 31), PackedInt32Array(31, 32, 34), PackedInt32Array(36, 35, 34), PackedInt32Array(34, 32, 36), PackedInt32Array(36, 32, 18), PackedInt32Array(36, 18, 37), PackedInt32Array(30, 38, 29), PackedInt32Array(29, 38, 39), PackedInt32Array(39, 38, 15), PackedInt32Array(38, 40, 15), PackedInt32Array(15, 40, 41), PackedInt32Array(35, 36, 40), PackedInt32Array(40, 36, 41), PackedInt32Array(15, 13, 39), PackedInt32Array(45, 44, 42), PackedInt32Array(42, 44, 43)]
geometry_collision_mask = 4278190096
geometry_source_geometry_mode = 1
cell_size = 0.2
cell_height = 0.2
agent_height = 1.0
agent_radius = 0.2
agent_max_climb = 0.1

[sub_resource type="CylinderShape3D" id="CylinderShape3D_dg77c"]
height = 2.64
radius = 0.019042969

[sub_resource type="AtlasTexture" id="AtlasTexture_ycdy4"]
atlas = ExtResource("11_efxa6")
region = Rect2(0, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_w48qg"]
atlas = ExtResource("11_efxa6")
region = Rect2(32, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_vivmo"]
atlas = ExtResource("11_efxa6")
region = Rect2(64, 0, 32, 32)

[sub_resource type="SpriteFrames" id="SpriteFrames_2cqfq"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_ycdy4")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_w48qg")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_vivmo")
}],
"loop": true,
"name": &"glow",
"speed": 3.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("14_w48qg")
}],
"loop": true,
"name": &"off",
"speed": 5.0
}]

[node name="Node3D" type="Node3D"]

[node name="time manager" type="Node" parent="." node_paths=PackedStringArray("timer_label")]
unique_name_in_owner = true
script = ExtResource("4_1bvp3")
timer_label = NodePath("../CanvasLayer/timer")

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="timer" type="Node2D" parent="CanvasLayer"]
script = ExtResource("2_7mycd")
font = SubResource("SystemFont_5vw27")
colour1 = Color(1, 1, 1, 1)
colour2 = Color(1, 0.6313726, 0, 1)
colour3 = Color(1, 0, 0, 1)

[node name="player_healthbar" type="Node2D" parent="CanvasLayer"]
script = ExtResource("3_272bh")
font = SubResource("SystemFont_kek77")
colour = Color(0.7670247, 2.5268644e-06, 9.62615e-07, 1)
flash_colour = Color(0.9506034, 0.29980722, 0.23307866, 1)

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(0.70710677, -0.35355338, 0.6123724, 0, 0.8660254, 0.5, -0.70710677, -0.35355338, 0.6123724, 24.495, 20, 24.495)
environment = SubResource("Environment_7dm0k")
projection = 1
size = 8.0
script = ExtResource("4_2cqfq")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.73391956, -0.5157324, 0.44202057, 0, 0.65076107, 0.7592827, -0.6792365, -0.5572524, 0.47760627, 0, 1.5492883, 0)
light_color = Color(0.94679576, 0.9999997, 0.9994717, 1)
shadow_enabled = true

[node name="physics_enemy" type="RigidBody3D" parent="." node_paths=PackedStringArray("player")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.3127089, 0.5889671, -0.86352944)
collision_layer = 4
collision_mask = 21
script = ExtResource("4_272bh")
player = NodePath("../player")

[node name="CollisionShape3D" type="CollisionShape3D" parent="physics_enemy"]
shape = SubResource("CylinderShape3D_kek77")

[node name="physics enemy visuals" type="Sprite3D" parent="physics_enemy"]
transform = Transform3D(0.70710677, -1.4142135, -3.090862e-08, 0, -8.742278e-08, 1, -0.70710677, -1.4142135, -3.090862e-08, 0, 0, 0)
pixel_size = 0.0313
alpha_cut = 1
texture_filter = 0
texture = ExtResource("1_0xm2m")
hframes = 16
vframes = 8
script = ExtResource("7_4c57u")

[node name="healthbar" type="Node2D" parent="physics_enemy"]
position = Vector2(0, -30)
script = ExtResource("5_5vw27")
max_value = 20.0
width = 48.0
height = 2.0

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="physics_enemy"]

[node name="damagebox" type="Area3D" parent="physics_enemy"]
collision_layer = 72
collision_mask = 2

[node name="CollisionShape3D" type="CollisionShape3D" parent="physics_enemy/damagebox"]
shape = SubResource("CylinderShape3D_5vw27")

[node name="hurtbox" type="Area3D" parent="physics_enemy"]
collision_layer = 8
collision_mask = 32

[node name="CollisionShape3D" type="CollisionShape3D" parent="physics_enemy/hurtbox"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.54534364, 0.62327814, -1.4321489)
shape = SubResource("CylinderShape3D_efxa6")
disabled = true

[node name="Line3D" type="Node2D" parent="physics_enemy"]
visible = false
script = ExtResource("4_kek77")

[node name="Line3D2" type="Node2D" parent="physics_enemy"]
visible = false
script = ExtResource("4_kek77")

[node name="Line3D3" type="Node2D" parent="physics_enemy"]
visible = false
script = ExtResource("4_kek77")

[node name="player" type="CharacterBody3D" parent="." node_paths=PackedStringArray("healthbar")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.2886999, 0, -1.1542073)
collision_mask = 21
script = ExtResource("2_h2yge")
healthbar = NodePath("../CanvasLayer/player_healthbar")

[node name="collisionboxshape" type="CollisionShape3D" parent="player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5803833, 0)
shape = SubResource("CapsuleShape3D_4c57u")

[node name="AnimatedSprite3D" type="AnimatedSprite3D" parent="player"]
transform = Transform3D(0.70710677, 0, 0.70710677, 0, 1.155, 0, -0.70710677, 0, 0.70710677, 0, 0.547, 0)
pixel_size = 0.0313
double_sided = false
alpha_cut = 1
texture_filter = 0
sprite_frames = ExtResource("3_h2yge")
animation = &"runningRF"
autoplay = "runningRF"

[node name="weapon_attachment" type="Node3D" parent="player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.05756426, 0.48761672, 0.049028516)

[node name="mining_laser_weapon" type="Node3D" parent="player/weapon_attachment"]
script = ExtResource("11_dg77c")

[node name="sparks" type="GPUParticles3D" parent="player/weapon_attachment/mining_laser_weapon"]
transform = Transform3D(0.70710677, 0, 0.70710677, 0, 1, 0, -0.70710677, 0, 0.70710677, 0, 0, 0)
emitting = false
amount = 32
lifetime = 0.3
process_material = SubResource("ParticleProcessMaterial_efxa6")
draw_pass_1 = SubResource("QuadMesh_ycdy4")

[node name="laser_mesh" type="MeshInstance3D" parent="player/weapon_attachment/mining_laser_weapon"]
visible = false
mesh = SubResource("CylinderMesh_efxa6")

[node name="hitbox" type="Area3D" parent="player"]
collision_layer = 2
collision_mask = 64

[node name="hitboxshape" type="CollisionShape3D" parent="player/hitbox"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.58096313, 0)
shape = SubResource("CapsuleShape3D_kek77")

[node name="cube" type="StaticBody3D" parent="." groups=["navigation_mesh_source_group"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5213611, -1.6070688)
collision_layer = 16
collision_mask = 21

[node name="CollisionShape3D" type="CollisionShape3D" parent="cube"]
shape = SubResource("BoxShape3D_7mycd")

[node name="MeshInstance3D" type="MeshInstance3D" parent="cube"]
mesh = SubResource("BoxMesh_272bh")

[node name="cube2" type="StaticBody3D" parent="." groups=["navigation_mesh_source_group"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.81429255, 0.5213611, -2.5040321)
collision_layer = 16
collision_mask = 21

[node name="CollisionShape3D" type="CollisionShape3D" parent="cube2"]
shape = SubResource("BoxShape3D_7mycd")

[node name="MeshInstance3D" type="MeshInstance3D" parent="cube2"]
mesh = SubResource("BoxMesh_272bh")

[node name="ground temp" type="StaticBody3D" parent="."]
visible = false
collision_layer = 16
collision_mask = 21

[node name="CollisionShape3D" type="CollisionShape3D" parent="ground temp"]
shape = SubResource("WorldBoundaryShape3D_7mycd")
disabled = true

[node name="MeshInstance3D" type="MeshInstance3D" parent="ground temp"]
mesh = SubResource("PlaneMesh_272bh")
skeleton = NodePath("../..")

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="."]
transform = Transform3D(0.9999959, -0.0022470858, 0.0018095938, 0.002249693, 0.9999964, -0.0014476246, -0.0018063514, 0.0014516684, 0.9999973, 0, 0, 0)
navigation_mesh = SubResource("NavigationMesh_4c57u")

[node name="wirelessCharger" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0)
collision_layer = 128
collision_mask = 2
script = ExtResource("12_ycdy4")

[node name="CollisionShape3D" type="CollisionShape3D" parent="wirelessCharger"]
shape = SubResource("CylinderShape3D_dg77c")

[node name="OmniLight3D" type="OmniLight3D" parent="wirelessCharger"]
light_color = Color(1, 0.88235295, 0.40784314, 1)
light_energy = 0.622
light_indirect_energy = 0.749
shadow_enabled = true
shadow_opacity = 0.26

[node name="AnimatedSprite3D" type="AnimatedSprite3D" parent="wirelessCharger"]
transform = Transform3D(0.70710677, 1.4142135, -3.090862e-08, 0, -8.742278e-08, -1, -0.70710677, 1.4142135, -3.090862e-08, 0, 0.01, 0)
pixel_size = 0.0313
texture_filter = 0
sprite_frames = SubResource("SpriteFrames_2cqfq")
animation = &"glow"
autoplay = "glow"
frame_progress = 0.71054417

[node name="GridMap" type="GridMap" parent="." groups=["navigation_mesh_source_group"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1, 0)
mesh_library = ExtResource("15_vivmo")
cell_size = Vector3(4, 2, 4)
collision_layer = 16
collision_mask = 21
data = {
"cells": PackedInt32Array(65535, 65534, 9, 65535, 65535, 9, 65535, 0, 9, 0, 0, 9, 0, 65535, 9, 0, 65534, 9, 1, 65535, 9, 1, 0, 9, 1, 65534, 9, 1, 65533, 9, 0, 65533, 9, 0, 65532, 11, 65535, 65532, 11, 65535, 65533, 9, 65534, 65533, 9, 65534, 65534, 9, 65533, 65534, 9, 65534, 65535, 9, 65534, 0, 9, 65534, 1, 9, 65535, 1, 9, 0, 1, 9, 1, 1, 9, 2, 0, 9, 2, 65535, 9, 2, 65534, 9, 2, 65533, 9, 1, 65532, 11, 65534, 65532, 11, 65533, 65532, 11, 65533, 65533, 9, 65533, 65535, 9, 65533, 0, 9, 65534, 2, 9, 65535, 2, 9, 0, 2, 9, 1, 2, 9, 2, 1, 9, 3, 65534, 10, 3, 65533, 10, 3, 65532, 15, 2, 65532, 11, 65532, 65532, 16, 65532, 65533, 12, 65532, 65534, 12, 65532, 65535, 12, 65532, 0, 12, 65532, 1, 12, 65532, 2, 12, 65532, 3, 17, 65533, 3, 13, 65533, 2, 12, 65533, 1, 12, 65534, 3, 13, 65535, 3, 13, 0, 3, 13, 1, 3, 13, 2, 2, 9, 2, 3, 13, 3, 3, 14, 3, 2, 10, 3, 1, 10, 3, 0, 10, 3, 65535, 10)
}

[connection signal="area_entered" from="physics_enemy/damagebox" to="physics_enemy" method="_on_damagebox_area_entered"]
[connection signal="area_exited" from="physics_enemy/damagebox" to="physics_enemy" method="_on_damagebox_area_exited"]
[connection signal="area_entered" from="wirelessCharger" to="wirelessCharger" method="_on_area_entered"]
[connection signal="area_exited" from="wirelessCharger" to="wirelessCharger" method="_on_area_exited"]
